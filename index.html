<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoOracle | 您的私人加密货币投资顾问</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { background-color: #050505; color: #e5e5e5; font-family: 'Inter', sans-serif; overflow: hidden; }
        
        /* 玻璃拟态效果 */
        .glass {
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        /* 聊天气泡样式 */
        .msg-ai { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border: 1px solid #334155; border-radius: 0px 15px 15px 15px; }
        .msg-user { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); border-radius: 15px 0px 15px 15px; }

        /* 打字机光标动画 */
        .cursor::after { content: '|'; animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        /* 支付锁遮罩层 */
        .locked-overlay {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(15px);
        }
        
        .neon-glow {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body class="flex flex-col h-screen relative">

    <header class="h-16 border-b border-white/10 flex items-center justify-between px-6 bg-black/50 z-10">
        <div class="flex items-center gap-2">
            <div class="w-3 h-3 rounded-full bg-emerald-500 animate-pulse"></div>
            <span class="font-bold text-lg tracking-wider">CRYPTO<span class="text-blue-500">ORACLE</span></span>
            <span class="text-[10px] bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded ml-2">AI PRO MODEL</span>
        </div>
        <div class="text-xs text-slate-500">v2.4.0 (Stable)</div>
    </header>

    <main id="chatContainer" class="flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth pb-32">
        <div class="flex gap-4 max-w-3xl mx-auto">
            <div class="w-8 h-8 rounded bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-xs font-bold">AI</div>
            <div class="msg-ai p-4 max-w-[85%] text-sm leading-relaxed shadow-lg">
                你好！我是 CryptoOracle 智能顾问。我可以帮你：
                <ul class="list-disc ml-5 mt-2 space-y-1 text-slate-400">
                    <li>分析 BTC/ETH 短期行情与风险</li>
                    <li>评估新发代币（Meme Coin）的合约安全性</li>
                    <li>为新手制定定投计划与止损策略</li>
                    <li>解读最新的美联储政策对币圈的影响</li>
                </ul>
                <div class="mt-4 text-blue-400 font-bold">请付费解锁以开始提问。</div>
            </div>
        </div>
    </main>

    <footer class="h-24 border-t border-white/10 p-4 bg-black/80 z-10">
        <div class="max-w-3xl mx-auto relative">
            <input type="text" id="userInput" disabled placeholder="请先解锁高级会员..." 
                   class="w-full bg-slate-900/50 border border-white/10 rounded-xl px-5 py-4 focus:outline-none text-slate-500 cursor-not-allowed transition-all">
            <button id="sendBtn" disabled class="absolute right-2 top-2 bottom-2 bg-slate-800 text-slate-500 px-6 rounded-lg font-bold cursor-not-allowed">
                发送
            </button>
        </div>
    </footer>

    <div id="paymentLock" class="absolute inset-0 locked-overlay z-50 flex flex-col items-center justify-center text-center px-4">
        <div class="glass p-10 rounded-3xl max-w-md w-full border-t border-blue-500/50 neon-glow relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 to-purple-600"></div>
            
            <h2 class="text-3xl font-black mb-2">解锁加密投资大脑</h2>
            <p class="text-slate-400 text-sm mb-8">获得 24/7 专业的风险评估与投资建议。一次性付费，永久使用。</p>
            
            <div class="flex items-center justify-center gap-2 mb-8">
                <span class="text-5xl font-bold text-white">29</span>
                <div class="text-left leading-tight">
                    <div class="text-xl font-bold text-blue-500">USDT</div>
                    <div class="text-[10px] text-slate-500">LIFETIME ACCESS</div>
                </div>
            </div>

            <div class="mb-6">
                <a href="https://nowpayments.io/payment/?iid=5883249315&source=button" target="_blank" rel="noreferrer noopener" 
                   class="block w-full py-4 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-xl transition transform hover:scale-105 shadow-lg shadow-blue-600/30 flex items-center justify-center gap-2">
                   <span>立即支付解锁</span>
                   <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                </a>
            </div>

            <button onclick="checkPayment()" class="text-xs text-slate-500 underline hover:text-white transition">
                我已经完成支付
            </button>

            <div class="mt-6 flex justify-center gap-4 opacity-50">
                <img src="https://nowpayments.io/images/coins/USDT.svg" class="w-6 h-6 grayscale hover:grayscale-0 transition">
                <img src="https://nowpayments.io/images/coins/BTC.svg" class="w-6 h-6 grayscale hover:grayscale-0 transition">
                <img src="https://nowpayments.io/images/coins/ETH.svg" class="w-6 h-6 grayscale hover:grayscale-0 transition">
            </div>
        </div>
    </div>

    <script>
        const chatBox = document.getElementById('chatContainer');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const paymentLock = document.getElementById('paymentLock');

        // 1. 支付解锁逻辑
        function checkPayment() {
            // 在实际商业项目中，你应该检查 URL 参数，例如 ?paid=true
            // 这里为了演示，点击即解锁
            const isConfirmed = confirm("系统正在链上核实您的 29 USDT 支付...\n\n(模拟：假设核实成功，点击确定进入)");
            if(isConfirmed) {
                unlockInterface();
            }
        }

        function unlockInterface() {
            paymentLock.style.opacity = '0';
            setTimeout(() => {
                paymentLock.classList.add('hidden');
            }, 500);

            userInput.disabled = false;
            sendBtn.disabled = false;
            userInput.placeholder = "请输入你的问题，例如：现在的比特币恐慌指数是多少？";
            userInput.classList.remove('cursor-not-allowed', 'bg-slate-900/50');
            userInput.classList.add('bg-slate-800', 'text-white');
            sendBtn.classList.remove('bg-slate-800', 'text-slate-500', 'cursor-not-allowed');
            sendBtn.classList.add('bg-blue-600', 'text-white', 'hover:bg-blue-500');
            
            appendMessage('ai', '验证成功！我是您的专属 AI 助手。请问您目前持有仓位吗？还是准备开始第一次投资？');
        }

        // 2. 消息发送逻辑
        sendBtn.addEventListener('click', handleSend);
        userInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') handleSend(); });

        async function handleSend() {
            const text = userInput.value.trim();
            if(!text) return;

            // 显示用户消息
            appendMessage('user', text);
            userInput.value = '';

            // AI 思考状态
            const loadingId = appendMessage('ai', '<span class="cursor">正在分析链上数据...</span>');

            // 3. 调用 AI (这里模拟调用，如果填入 Key 则为真实调用)
            try {
                const aiResponse = await fetchAIResponse(text);
                updateMessage(loadingId, aiResponse);
            } catch (error) {
                updateMessage(loadingId, "网络连接繁忙，请稍后再试。");
            }
        }

        // 4. OpenAI API 调用核心代码
        async function fetchAIResponse(userText) {
            // *** 关键设置：如果你有 OpenAI API Key，请在这里填入 ***
            // 如果没有 Key，保留为空，代码会使用下方的“演示回复模式”
            const API_KEY = ""; 
            
            if (!API_KEY) {
                // 演示模式：模拟 AI 回复
                return new Promise(resolve => {
                    setTimeout(() => {
                        resolve(generateMockResponse(userText));
                    }, 1500); // 模拟延迟
                });
            }

            // 真实模式：调用 GPT-4o 或 GPT-3.5
            const response = await fetch("https://api.openai.com/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${API_KEY}`
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo",
                    messages: [
                        {role: "system", content: "你是一个专业的加密货币投资顾问。回答要简短、专业，并提示风险。"},
                        {role: "user", content: userText}
                    ]
                })
            });
            const data = await response.json();
            return data.choices[0].message.content;
        }

        // 5. 演示用的自动回复库 (当没有 API Key 时使用)
        function generateMockResponse(text) {
            if(text.includes("比特币") || text.includes("BTC")) return "根据当前技术面分析，BTC 在 $96,000 附近面临阻力。如果突破该位置，可能会测试 $100,000 大关。建议关注 4 小时级别的 RSI 指标。";
            if(text.includes("风险")) return "加密货币属于高风险资产。建议新手将仓位控制在总资产的 10% 以内，并准备好冷钱包存储资产，不要将所有资金放在交易所。";
            if(text.includes("以太坊") || text.includes("ETH")) return "ETH 目前受制于 Gas 费和 Layer 2 的竞争。长期来看，其通缩机制依然是利好，但短期波动较大，建议定投。";
            return "这是一个很好的问题。作为新手，你需要先学会如何使用 Etherscan 查看链上交易，并区分中心化交易所(CEX)和去中心化交易所(DEX)的区别。";
        }

        // UI 辅助函数
        function appendMessage(role, html) {
            const div = document.createElement('div');
            const id = 'msg-' + Date.now();
            div.id = id;
            div.className = `flex gap-4 max-w-3xl mx-auto ${role === 'user' ? 'flex-row-reverse' : ''}`;
            
            div.innerHTML = `
                <div class="w-8 h-8 rounded shrink-0 flex items-center justify-center text-xs font-bold ${role === 'ai' ? 'bg-gradient-to-br from-blue-500 to-purple-600' : 'bg-slate-600'}">
                    ${role === 'ai' ? 'AI' : 'ME'}
                </div>
                <div class="${role === 'ai' ? 'msg-ai' : 'msg-user'} p-4 max-w-[85%] text-sm leading-relaxed shadow-lg text-white">
                    ${html}
                </div>
            `;
            chatBox.appendChild(div);
            chatBox.scrollTop = chatBox.scrollHeight;
            return id;
        }

        function updateMessage(id, text) {
            const el = document.getElementById(id).querySelector('.msg-ai');
            el.innerHTML = text; // 这里可以接入 markdown 解析器
        }
    </script>
</body>

</html>
